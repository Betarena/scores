# â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
# â”‚ ğŸ“Œ High Order Overview                                                           â”‚
# â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
# â”‚ â¤ Code Format   // V.8.0                                                         â”‚
# â”‚ â¤ Status        // ğŸ”’ LOCKED                                                     â”‚
# â”‚ â¤ Author(s)     // @migbash                                                      â”‚
# â”‚ â¤ Maintainer(s) // @migbash                                                      â”‚
# â”‚ â¤ Created on    // <date-created>                                                â”‚
# â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
# â”‚ ğŸ“ Description                                                                   â”‚
# â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
# â”‚ BETARENA (Module)
# â”‚ |: Docker Compose Configuration
# â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

name: betarena-scores

services:

  # â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  # â”‚ ğŸŸ© â”‚ NGINX CONTAINER(s)                                                          â”‚
  # â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  nginx:
    image: nginx:1.27.1
    container_name: proxy
    ports:
      - 80:80
      - 443:443
      - 8081:8081
      # â•­â”€â”€â”€â”€â”€
      # â”‚ NOTE:
      # â”‚ |: Pors for DEVELOPMENT (LOCAL) [commented out]
      # â•°â”€ â¤¦â¤¦â¤¦â¤¦
      # - 8080:8080
    command: ["nginx", "-g", "daemon off;"]
    volumes:
      # â•­â”€â”€â”€â”€â”€
      # â”‚ NOTE:
      # â”‚ |: Volumes for PRODUCTION
      # â•°â”€ â¤¦â¤¦â¤¦â¤¦
      - ${HOME}/../etc/letsencrypt:/etc/letsencrypt:ro
      - ../.docker/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ../.docker/goaccess:/etc/nginx/html:ro
      - ../.docker/nginx/logs/scores:/var/log/nginx/scores:rw
      - ../.docker/nginx/logs/goaccess:/var/log/nginx/goaccess:rw
      # â•­â”€â”€â”€â”€â”€
      # â”‚ NOTE:
      # â”‚ |: Volumes for DEVELOPMENT (LOCAL) [commented out]
      # â•°â”€ â¤¦â¤¦â¤¦â¤¦
      # - ../.docker/nginx/nginx.dev.conf:/etc/nginx/nginx.conf:ro
    networks:
      - loadbalancer
    logging:
      driver: local
      options:
        max-size: 1g
        max-file: 5
  #

  goaccess:
    image: allinurl/goaccess:1.9.3
    container_name: goaccess
    ports:
      - 7890:7890
    volumes:
      - ../.docker/nginx/logs/scores:/var/log/nginx:ro
      - ../.docker/goaccess:/srv:rw
    command: --config-file=/srv/goaccess.conf --log-file=/var/log/nginx/access.log --log-format=COMBINED --output=/srv/index.html --real-time-html --ping-interval=5
    depends_on:
      - nginx
  #

  # â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  # â”‚ ğŸŸ¦ â”‚ APPLICATION CONTAINER(s)                                                    â”‚
  # â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  web-prod:
    # â•­â”€â”€â”€â”€â”€
    # â”‚ WARNING:
    # â”‚ |: Does not work with 'deploy.replicas: [n]' configuration
    # â•°â”€â”€â”€â”€â”€
    # container_name: scores
    restart: always
    # â•­â”€â”€â”€â”€â”€
    # â”‚ NOTE:
    # â”‚ |: For for DEVELOPMENT (LOCAL) [commented out]
    # â•°â”€ â¤¦â¤¦â¤¦â¤¦
    # build:
    #   context: ../
    #   dockerfile: ./.docker/Dockerfile
    deploy:
      replicas: ${BETARNA_SCORES__REPLICAS:-1}
    env_file: ../env/.env.docker.scores
    expose:
      - 3000
    # â•­â”€â”€â”€â”€â”€
    # â”‚ NOTE:
    # â”‚ |: For for DEVELOPMENT (LOCAL) [commented out]
    # â•°â”€ â¤¦â¤¦â¤¦â¤¦
    # ports:
      # - 3000:3000
    logging:
      driver: local
      options:
        max-size: 500m
        max-file: 5
    networks:
      - loadbalancer
  #

networks:
  loadbalancer:
    driver: bridge
#