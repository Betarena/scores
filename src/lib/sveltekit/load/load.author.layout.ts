// â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
// â”‚ ğŸ“Œ High Order Overview                                                           â”‚
// â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
// â”‚ â¤ Code Format   // V.8.0                                                         â”‚
// â”‚ â¤ Status        // ğŸ”’ LOCKED                                                     â”‚
// â”‚ â¤ Author(s)     // @migbash                                                      â”‚
// â”‚ â¤ Maintainer(s) // @migbash                                                      â”‚
// â”‚ â¤ Created on    // <date-created>                                                â”‚
// â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
// â”‚ ğŸ“ Description                                                                   â”‚
// â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
// â”‚ BETARENA (Module)
// â”‚ |: <insert-module-summary-here>
// â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

// #region â¤ ğŸ“¦ Package Imports

import { dlogv2 } from '$lib/utils/debug';
import { promiseUrlsPreload } from '$lib/utils/navigation.js';
import { parseObject } from '$lib/utils/string.2.js';

import type { ServerLoadEvent } from '@sveltejs/kit';

// #endregion â¤ ğŸ“¦ Package Imports

// #region â¤ ğŸ“Œ VARIABLES

const
  /**
   * @description
   * ğŸ“ Debugging tag.
   */
  strDebugModule = 'src/routes/(authors)/a/+layout.server.ts'
;

// #endregion â¤ ğŸ“Œ VARIABLES

// #region â¤ â›©ï¸ TYPES

/**
 * @author
 *  @migbash
 * @summary
 *  ğŸ”¹ INTERFACE
 * @description
 *  ğŸ“ Target `types` for `_this_` page required at preload.
 */
type IPreloadData0 =
[
  any,
  any,
  any,
  any
];

/**
 * @author
 *  @migbash
 * @summary
 *  ğŸ”¹ INTERFACE
 * @description
 *  ğŸ“ Interface for `_this_` page required at preload.
 */
interface IPreloadResponse
{
  /**
   * @description
   *  ğŸ“ Target `data` returned.
   */
  translations?: undefined;
  /**
   * @description
   *  ğŸ“ Target `data` returned.
   */
  articleTranslation?: undefined;
  /**
   * @description
   *  ğŸ“ Target `data` returned.
   */
  profile_translation?: undefined;
}

// #endregion â¤ â›©ï¸ TYPES

// â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
// â”‚ ğŸŸ¥ â”‚ LOGIC - MAIN                                                                â”‚
// â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

/**
 * @author
 *  @migbash
 * @summary
 *  â™¦ï¸ MAIN
 * @description
 *  ğŸ“ Logic for 'src/routes/(authors)/a/+layout.server.ts' route data preload.
 * @example
 *  [1]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 *  â”‚ main
 *  â”‚ (
 *  â”‚   <-sveltekit-server-preload-event-instance->
 *  â”‚ );
 *  â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 *  â”‚ DESCRIPTION
 *  â”‚ : Main logic for route `src/routes/(authors)/a/+layout.server.ts` for respective data preload.
 *  â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 *  â”‚ OUTPUT
 *  â”‚ : Returns `data` for `_this_` preload.
 *  [X]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * @param { ServerLoadEvent } event
 *  â—ï¸ **REQUIRED** instance of `ServerLoadEvent` object.
 * @param { object } objParentPreloadData
 *  â—ï¸ **REQUIRED** instance of `object` containing `langParam`.
 * @param { string } objParentPreloadData.langParam
 *  â—ï¸ **REQUIRED** `langParam` for target language.
 * @return { Promise < {} > }
 *  ğŸ“¤ Respective `data` for _this_ route.
 */
export async function main
(
  event: ServerLoadEvent,
  objParentPreloadData:
  {
    langParam: string
  }
): Promise < IPreloadResponse >
{
  // [ğŸ]
  dlogv2
  (
    `ğŸš checkpoint â¤ ${strDebugModule} main(..) // START`,
    [
      `ğŸ”¹ [var] â¤ objParentPreloadData :|: ${parseObject(objParentPreloadData)}`,
    ]
  );

  let
    /**
     * @description
     *  ğŸ“ Initialize page response
     */
    objResponse: IPreloadResponse = {}
  ;

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ ğŸ—ï¸ â”‚ PAGE DATA BUNDLING                                                          â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  // â•­â”€â”€â”€â”€â”€
  // â”‚ NOTE:
  // â”‚ |: Destruct `object`.
  // â•°â”€â”€â”€â”€â”€
  [
    objResponse.translations,
    objResponse.articleTranslation,
    objResponse.profile_translation
  ] = await fetchData
  (
    event.fetch,
    objParentPreloadData.langParam
  );

  // â•­â”€â”€â”€â”€â”€
  // â”‚ NOTE: IMPORTANT
  // â”‚ |: Requires flattening of first-level `object`, to prevent `undefined` values in page.
  // â•°â”€â”€â”€â”€â”€
  objResponse = {
    // @ts-expect-error :: expceted to be destructed for respective page data, the way it was structured.
    ...objResponse.translations,
    // @ts-expect-error :: expceted to be destructed for respective page data, the way it was structured.
    ...objResponse.profile_translation,
    // @ts-expect-error :: expceted to be destructed for respective page data, the way it was structured.
    readingTime: objResponse.articleTranslation?.translation
  };

  // [ğŸ]
  dlogv2
  (
    `ğŸš checkpoint â¤ ${strDebugModule} main(..) // END`,
    [
      // `ğŸ”¹ [var] â¤ objResponse :|: ${JSON.stringify(objResponse)}`,
    ]
  );

  return objResponse;
}

// â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
// â”‚ ğŸŸ¦ â”‚ LOGIC - HELPER                                                              â”‚
// â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

/**
 * @author
 *  @migbash
 * @summary
 *  ğŸ”· HELPER
 * @description
 *  ğŸ“ Fetches target data for `_this_` page.
 * @example
 *  [1]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 *  â”‚ fetchData
 *  â”‚ (
 *  â”‚   <-sveltekit-fetch-instance->,
 *  â”‚   'es'
 *  â”‚ );
 *  â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 *  â”‚ DESCRIPTION
 *  â”‚ : Fetches target data for `_this_` page.
 *  â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 *  â”‚ OUTPUT
 *  â”‚ : Returns `data` for `_this_` page.
 *  [X]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * @param { any } fetch
 *  â—ï¸ **REQUIRED** Instance of `fetch` object.
 * @param { string } lang
 *  â—ï¸ **REQUIRED** `lang`.
 * @returns { Promise < IPreloadData0 > }
 *  ğŸ“¤ Target `data` fetched.
 */
async function fetchData
(
  fetch: any,
  lang: string
): Promise < IPreloadData0 >
{
  const
    /**
     * @description
     *  ğŸ“ Load translations for articles layout
     */
    listUrls
      = [
        `/api/data/author/tags?translation=${lang}`,
        `/api/data/author/article?lang=${lang}`,
        `/api/data/author/translations?lang=${lang}`

      ],
    /**
     * @description
     *  ğŸ“ Target `data` returned.
     */
    dataRes0
      = await promiseUrlsPreload
      (
        listUrls,
        fetch
      ) as IPreloadData0
  ;

  return dataRes0;
}
