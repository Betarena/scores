<!--
‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
### COMPONENT JS (w/ TS)                                                               ‚óºÔ∏è
### NOTE:                                                                              ‚óºÔ∏è
### access custom Betarena Scores JS VScode Snippets by typing 'script...'             ‚óºÔ∏è
‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
-->

<script lang="ts">

  // #region ‚û§ üì¶ Package Imports

  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  // ### NOTE:                                                            ‚óºÔ∏è
  // ### Please add inside 'this' region the 'imports' that are required  ‚óºÔ∏è
  // ### by 'this' .svelte file is ran.                                   ‚óºÔ∏è
  // ### IMPORTANT                                                        ‚óºÔ∏è
  // ### Please, structure the imports as follows:                        ‚óºÔ∏è
  // ### 1. svelte/sveltekit imports                                      ‚óºÔ∏è
  // ### 2. project-internal files and logic                              ‚óºÔ∏è
  // ### 3. component import(s)                                           ‚óºÔ∏è
  // ### 4. assets import(s)                                              ‚óºÔ∏è
  // ### 5. type(s) imports(s)                                            ‚óºÔ∏è
  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è

  import { browser } from '$app/environment';
  import { page } from '$app/stores';
  import { onDestroy, onMount } from 'svelte';
  import { fade, fly } from 'svelte/transition';

	import sessionStore from '$lib/store/session.js';
	import userBetarenaSettings from '$lib/store/user-settings.js';
	import { createWeb3Modal, defaultConfig } from '@web3modal/ethers5';
	import { BigNumber, ethers, type ContractInterface, type Transaction } from 'ethers';
// read-more :|: https://www.npmjs.com/package/web3modal

  import { get, post } from '$lib/api/utils.js';
  import { dlog, dlogv2 } from '$lib/utils/debug.js';
  import { shortenWeb3WalletAddress, toDecimalFix, viewport_change } from '$lib/utils/platform-functions.js';
  import { passByValue } from '@betarena/scores-lib/dist/functions/func.common.js';
  import { tryCatchAsync } from '@betarena/scores-lib/dist/util/util.common.js';

  import icon_checkbox from '../assets/checkbox.svg';
  import icon_arrow_down_dark from '../assets/common/arrow-down-dark.svg';
  import icon_arrow_down from '../assets/common/arrow-down.svg';
  import icon_arrow_right_dark from '../assets/common/arrow-right-dark.svg';
  import icon_arrow_right from '../assets/common/arrow-right.svg';
  import icon_close_dark from '../assets/icon-close-dark.svg';
  import icon_close from '../assets/icon-close.svg';
  import icon_bronze from '../assets/price-tier/icon-bta-bronze.svg';
  import icon_gold from '../assets/price-tier/icon-bta-gold.svg';
  import icon_platinum from '../assets/price-tier/icon-bta-platinum.svg';
  import icon_silver from '../assets/price-tier/icon-bta-silver.svg';
  import icon_bta_token from '../assets/price-tier/icon-bta-token.svg';
  import icon_usdc from '../assets/price-tier/icon-usdc.png';
  import icon_usdt from '../assets/price-tier/icon-usdt.png';
  import betarenaBankContractABI from './web3/BetarenaBankABI.json';
// read-more :|: https://mumbai.polygonscan.com/address/0x38eb8b22df3ae7fb21e92881151b365df14ba967#code
  // read-more :|: https://api-testnet.polygonscan.com/api?module=contract&action=getabi&address=0x38eb8b22df3ae7fb21e92881151b365df14ba967&format=raw
  import usdcContractAddressABI from './web3/UsdcABI.json';
  // read-more :|: https://mumbai.polygonscan.com/token/0x3813e82e6f7098b9583fc0f33a962d02018b6803#code
  import usdtContractAddressABI from './web3/UsdtABI.json';

  import ModalTermsAndConditions from './Modal-TermsAndConditions.svelte';
  import ModalTxState from './Modal-Tx-State.svelte';

  import type { B_H_INVEST_WIDGET_Data, B_H_TH } from '@betarena/scores-lib/types/_HASURA_.js';
  import type { ICoinMarketCapDataMain } from '@betarena/scores-lib/types/_WEB3_.js';
  import type { B_PROF_D, B_PROF_T } from '@betarena/scores-lib/types/profile.js';
  import type { Web3Modal } from '@web3modal/ethers5/dist/types/src/client.js';

  // #endregion ‚û§ üì¶ Package Imports

  // #region ‚û§ üìå VARIABLES

  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  // ### NOTE:                                                            ‚óºÔ∏è
  // ### Please add inside 'this' region the 'variables' that are to be   ‚óºÔ∏è
  // ### and are expected to be used by 'this' .svelte file / component.  ‚óºÔ∏è
  // ### IMPORTANT                                                        ‚óºÔ∏è
  // ### Please, structure the imports as follows:                        ‚óºÔ∏è
  // ### 1. export const / let [..]                                       ‚óºÔ∏è
  // ### 2. const [..]                                                    ‚óºÔ∏è
  // ### 3. let [..]                                                      ‚óºÔ∏è
  // ### 4. $: [..]                                                       ‚óºÔ∏è
  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è

  export let
    /** @inheritdoc */
    WIDGET_DATA: B_PROF_D
  ;

  // ### @see :|: https://stackoverflow.com/questions/72230897/how-to-call-a-smart-contract-function-with-walletconnect-react-js-node-js
  // ### @see :|: https://wiki.polygon.technology/docs/tools/wallets/walletconnect/

  interface ITierDiscount
  {
    /** @description tier discount name */
    name?: string,
    /** @description tier discount icon. */
    icon?: string,
    /** @description tier discount number. */
    discount?: number,
  }

  interface ICryptoDesposit
  {
    /** @description cryptocurrency full name */
    full_name: string;
    /** @description cryptocurrency symbol */
    name: string;
    /** @description cryptocurrency icon */
    icon: string;
    /** @description cryptocurrency address */
    contractAddress: string;
    /** @description cryptocurrency ABI */
    abi: unknown;
    /** @description cryptocurrency user amount */
    userBalance: any;
  }

  type IStateWidget = 'In Progress' | 'Completed' | 'Error' | null;

  const
    /** @description üìå `this` component **main** `id` and `data-testid` prefix. */
    CNAME = 'profile‚Æïw‚Æïinvestbox‚Æïmain',
    // ‚óºÔ∏è IMPORTANT
    VIEWPORT_MOBILE_INIT = 575,
    VIEWPORT_TABLET_INIT = 1160,
    /** @description target `polygon` blockchain `BetarenaBank` polygon mumbai (testnet) */
    betarenaBankContractAddress: string = '0x5BC335e9c9492B8abb07B49a6dbD8269d7419F1D'
    /** @description TODO: */
    // provider = EthereumProvider.init({ .. })
  ;

  let
    // ‚óºÔ∏è IMPORTANT
    isViewMobile: boolean = false
    , isViewTablet: boolean = false
    /** @description Profile Translation data. */
    , B_PROF_T: B_PROF_T
    /** @description Creating a Web3Modal with `WalletConnect`. */
    , modal: Web3Modal = createWeb3Modal
    (
      {
        // ‚ñì @see :> get projectId at https://cloud.walletconnect.com
        projectId: 'a523c408585b0f7c88a7df7a9d70dfe6'
        , ethersConfig: defaultConfig
        (
          {
            metadata:
            {
              name: 'My Website',
              description: 'My Website description',
              url: 'https://mywebsite.com',
              icons: ['https://avatars.mywebsite.com/']
            }
          }
        )
        , chains:
        [
          // {
          //   chainId: 1,
          //   name: 'Ethereum',
          //   currency: 'ETH',
          //   explorerUrl: 'https://etherscan.io',
          //   rpcUrl: 'https://cloudflare-eth.com'
          // },
          {
            chainId: 80001,
            name: 'Mumbai Testnet',
            currency: 'MATIC',
            explorerUrl: 'https://mumbai.polygonscan.com',
            rpcUrl: 'https://polygon-mumbai.g.alchemy.com/v2/0zWtf5I24NBkM826G-VJFiYkkGoC5atJ'
          }
        ]
        , defaultChain:
        {
          chainId: 80001,
          name: 'Mumbai Testnet',
          currency: 'MATIC',
          explorerUrl: 'https://mumbai.polygonscan.com',
          rpcUrl: 'https://polygon-mumbai.g.alchemy.com/v2/0zWtf5I24NBkM826G-VJFiYkkGoC5atJ'
        }
      }
    )
    /** @description üì£ investor data (map) */
    , mapInvestorData: Map < string, B_H_INVEST_WIDGET_Data > = new Map
    (
      WIDGET_DATA?.investor
    ) as Map < string, B_H_INVEST_WIDGET_Data >
    /** @description wether user has triggered the `invest` action. */
    , triggerInvestBox: boolean = false
    /** @description wether user has triggered the `invest` action. */
    , stateWidget: IStateWidget = null
    /** @description prices of supported tokens. */
    , cryptoPrices: ICoinMarketCapDataMain
    /** @description target token price. */
    , cryptoPrice: number
    /** @description amount user wishes to `deposit`. */
    , depositAmount: number = 2500
    /** @description amount user wishes to `recieve`. */
    , recieveAmount: number = 2500
    /** @description target selected option by user. */
    , selectDepositOption: 'crypto' | 'fiat' = 'crypto'
    /** @description tier discount data object */
    , tierDiscountObject: ITierDiscount = { }
    /** @description terms&conditions checkbox */
    , agreeTermsAndConditions: boolean = false
    /** @description crypto deposit data object list */
    , cryptoDepositOptions: ICryptoDesposit[] =
    [
      {
        full_name: 'USD Coin',
        name: 'USDC',
        icon: icon_usdc,
        contractAddress: '0x0FA8781a83E46826621b3BC094Ea2A0212e71B23',
        abi: usdcContractAddressABI,
        userBalance: null
      },
      {
        full_name: 'Tether',
        name: 'USDT',
        icon: icon_usdt,
        contractAddress: '0x3813e82e6f7098b9583FC0F33a962D02018B6803',
        abi: usdtContractAddressABI,
        userBalance: null
      }
    ]
    /** @description crypto deposit data object list (search) */
    , cryptoDepositOptionsSearch: ICryptoDesposit[] = passByValue(cryptoDepositOptions)
    /** @description crypto deposit object selected */
    , cryptoDepositOptionSelect: ICryptoDesposit = cryptoDepositOptions?.[0]
    /** @description modal open select cryptocurrency option */
    , modalSelectCryptoOption: boolean = false
    /** @description modal open select cryptocurrency option */
    , walletAddress: string
    /** @description search text for target token */
    , tokenSearch: string
    /** @description interval for CoinMarketCap fetching */
    , interval1: NodeJS.Timer
    /** @description üì£ modal unsubsribe events (callback) */
    , modalUnsubscribe: Array < () => void > = []
  ;

  $: B_PROF_T = $page.data?.RESPONSE_PROFILE_DATA;
  $: deepReactListenSignerChange = undefined;
  $: deepReactListenDepositOptionChange = JSON.stringify(cryptoDepositOptionSelect);

  // #endregion ‚û§ üìå VARIABLES

  // #region ‚û§ üõ†Ô∏è METHODS

  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  // ### NOTE:                                                            ‚óºÔ∏è
  // ### Please add inside 'this' region the 'methods' that are to be     ‚óºÔ∏è
  // ### and are expected to be used by 'this' .svelte file / component.  ‚óºÔ∏è
  // ### IMPORTANT                                                        ‚óºÔ∏è
  // ### Please, structure the imports as follows:                        ‚óºÔ∏è
  // ### 1. function (..)                                                 ‚óºÔ∏è
  // ### 2. async function (..)                                           ‚óºÔ∏è
  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è

  /**
   * @author
   *  @migbash
   * @summary
   *  üü• COMPONENT MAIN
   * @description
   *  üì£ Document (visibility-change) event listener;
   * @returns { void }
   */
  function addEventListeners
  (
  ): void
  {
    // NOTE: (on-visibility-change)
    document.addEventListener
    (
      'visibilitychange',
      async function
      (
      )
      {
        if (!document.hidden)
        {
          dlog('üîµ user is active', true);
          getCryptoPrices();
        }
        else
        {
          dlog('üî¥ user is not-active', true);
          // @ts-expect-error
          clearInterval(interval1);
        }
      }
    );
    // NOTE: (on-resize)
    window.addEventListener
    (
      'resize',
      function ()
      {
        resizeAction();
      }
    );

    const modalUnsub1 = modal.subscribeEvents
    (
      (
        e
      ) =>
      {
        // ### [üêû]
        dlogv2
        (
          `üöè checkpoint [R] ‚û§ if_R_X342`,
          [
            `üîπ [var] ‚û§ e.data.event ${e.data.event}`,
          ],
          true
        );

        if (e.data.event == 'MODAL_OPEN')
          $sessionStore.showDepositModalState = true;
        if (e.data.event == 'MODAL_CLOSE')
          $sessionStore.showDepositModalState = false;
      }
    );

    const modalUnsub2 = modal.subscribeProvider
    (
      async (
        newProvider
      ): Promise < void > =>
      {
        // ### [üêû]
        dlogv2
        (
          `üöè checkpoint [R] ‚û§ if_R_X12`,
          [
            newProvider,
            `üîπ [var] ‚û§ modal.getSigner() ${modal.getSigner()}`,
            `üîπ [var] ‚û§ modal.getAddress() ${modal.getAddress()}`,
          ],
          true
        );

        deepReactListenSignerChange = newProvider?.isConnected;
        walletAddress = modal?.getAddress();
        await switchUserNetwork();

        return;
      }
    );

    modalUnsubscribe.push(modalUnsub1);
    modalUnsubscribe.push(modalUnsub2);
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü• COMPONENT MAIN
   * @description
   *  üì£ Update variables for viewport state.
   * @returns { void }
   */
  function resizeAction
  (
  ): void
  {
    [
      isViewTablet,
      isViewMobile
    ] = viewport_change
    (
      VIEWPORT_TABLET_INIT,
      VIEWPORT_MOBILE_INIT
    );
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü¶ HELPER
   * @description
   *  üì£ Search Token.
   * @returns { void }
   */
  function searchToken
  (
  ): void
  {
    // ‚ñì NOTE:
    // ‚ñì > reset data.
		cryptoDepositOptionsSearch = [];

    const _searchTarget: string = tokenSearch.toLowerCase();

		// ‚ñì CHECK
    // ‚ñì > for matching token names.
		for (const item of cryptoDepositOptions ?? [])
    {
      // ‚ñì NOTE:
      // ‚ñì > search by: (1) shortname, (2) fullname, (3) contract-address;
      const if_M_0: boolean =
        item?.name?.toLowerCase().includes(_searchTarget)
        || item?.full_name?.toLowerCase().includes(_searchTarget)
        || item?.contractAddress?.toLowerCase().includes(_searchTarget)
      ;

      if (if_M_0) cryptoDepositOptionsSearch.push(item);
		}

    return;
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü• COMPONENT MAIN
   * @description
   *  üì£ Obtains target user target **selected ERC-20 token** balance.
   * @returns { Promise < void > }
   */
  async function getTokenBalance
  (
  ): Promise < void >
  {
    await tryCatchAsync
    (
      async (
      ): Promise < void > =>
      {
        const
          contract = new ethers.Contract
          (
            cryptoDepositOptionSelect?.contractAddress,
            cryptoDepositOptionSelect?.abi as ContractInterface,
            modal.getSigner(),
          )
        ;

        const numberDecimals = await contract?.decimals();
        const numberUserBalance = await contract?.balanceOf(modal?.getAddress());
        cryptoDepositOptionSelect.userBalance = ethers.utils.formatUnits(numberUserBalance?.toString(), numberDecimals);

        // ‚ñì [üêû]
        dlogv2
        (
          ``
          , [
            `numberDecimals ${numberDecimals}`,
            `numberUserBalance ${numberUserBalance}`,
            `modal?.getAddress() ${modal?.getAddress()}`,
          ]
        );

        return;
      }
      ,
      (
        ex: unknown
      ): void =>
      {
        console.error(`üíÄ Unhandled :: ${ex}`);

        return;
      }
    );

    return;
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü¶ HELPER
   * @description
   *  üì£ Promots user `network` switch.
   * @returns { void }
   */
  async function switchUserNetwork
  (
  ): Promise < void >
  {
    if (!browser) return;

    await tryCatchAsync
    (
      async (
      ) : Promise < void > =>
      {
        return await window.ethereum.request
        (
          {
            method: "wallet_addEthereumChain",
            params:
            [
              {
                chainId: "0x13881",
                chainName: "Mumbai Testnet",
                rpcUrls: ["https://polygon-mumbai.g.alchemy.com/v2/0zWtf5I24NBkM826G-VJFiYkkGoC5atJ"],
                nativeCurrency:
                {
                  name: "MATIC",
                  symbol: "MATIC",
                  decimals: 18,
                },
                blockExplorerUrls: ["https://mumbai.polygonscan.com"],
              },
            ],
          }
        )
      }
      , (
        ex: unknown
      ): void =>
      {
        console.error(`üíÄ Unhandled :: ${ex}`);

        return;
      }
    );

    return;
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü¶ HELPER
   * @description
   *  üì£ Toggle (connect/disconnect) `web3` wallet connection.
   * @returns { Promise < void > }
   */
  async function connectWallet
  (
  ): Promise < void >
  {
    if (!browser) return;

    // ‚ñì CHECK
    // ‚ñì > for (1) existing signer + (2) not a 'Buy BTA' action;
    // ‚ñì NOTE:
    // ‚ñì > web3 disconnect + exit;
    if (deepReactListenSignerChange && !triggerInvestBox)
    {
      await modal.disconnect();
      return;
    }

    await modal.open({ view: 'Connect' });

    return;
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü¶ HELPER
   * @description
   *  üì£ Initialize deposit action.
   * @returns { Promise < void > }
   */
  async function executeDeposit
  (
  ): Promise < void >
  {
    if (!browser) return;

    triggerInvestBox = true;

    if (!deepReactListenSignerChange)
      await connectWallet();
    ;

    return;
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü¶ HELPER
   * @description
   *  üì£ Interact with `deployed` contract and perform `deposit` logic.
   * @returns { Promise < void > }
  */
  async function executeContract
  (
  ): Promise < void >
  {
    if (!browser) return;

    // ‚ñì [üêû]
    console.log('üì£', modal.getSigner());
    // ‚ñì [üêû]
    console.log('üì£', modal.getIsConnected());

    stateWidget = 'In Progress';
    $sessionStore.showDepositModalState = true;

    await switchUserNetwork();

    let
      errors: boolean = false
      , targetDecimals: number
      , targetAmount: BigNumber
    ;

    // @see :> https://docs.alchemy.com/reference/error-reference

    // ‚ñì NOTE:
    // ‚ñì > execute `.approve(..)` logic for `allowance` for `ERC20` tokens.
    // ‚ñì > prior to effectuating a `deposit`/`transfer` of funds.
    await tryCatchAsync
    (
      async (
      ): Promise < void > =>
      {
        const
          contract = new ethers.Contract
          (
            cryptoDepositOptionSelect?.contractAddress,
            cryptoDepositOptionSelect?.abi as ContractInterface,
            modal.getSigner(),
          )
        ;

        targetDecimals = await contract?.decimals();
        targetAmount = ethers.utils.parseUnits(depositAmount?.toString(), targetDecimals);

        const transactionResponse: Transaction = await contract?.approve(betarenaBankContractAddress, targetAmount);

        // ‚ñì [üêû]
        dlogv2
        (
          ``
          , [
            `targetDecimals ${targetDecimals}`,
            `targetAmount ${targetAmount}`,
            `transactionResponse ${transactionResponse}`
          ]
        );

        return;
      }
      ,
      (
        ex: unknown
      ): void =>
      {
        errors = true;

        // ‚ñì [üêû]
        if (ex?.toString()?.includes('ACTION_REJECTED'))
          console.info('üì£ The user has rejected the transaction.');
        else if (ex?.toString()?.includes('Error: Internal JSON-RPC error.'))
          // ‚ñì see :> https://support.metamask.io/hc/en-us/articles/360059289871-Error-Internal-JSON-RPC-error-when-trying-to-interact-with-other-networks
          console.info('‚ùå Something is not right, please recheck everything again.');
        else if (ex?.toString()?.includes('code=CALL_EXCEPTION'))
          console.info('‚ùå ERR :: Incorrect selected chain by client/user');
        else
          console.error(`üíÄ Unhandled :: ${ex}`);

        return;
      }
    );

    // ‚ñì CHECK
    // ‚ñì > for errors registered.
    if (errors)
    {
      triggerInvestBox = false;
      stateWidget = 'Error';
      $sessionStore.showDepositModalState = false;
      return;
    }

    // ‚ñì NOTE:
    // ‚ñì > execute `.depositTokens(..)` on the target `SmartContract`.
    await tryCatchAsync
    (
      async (
      ): Promise < void > =>
      {
        const
          contract = new ethers.Contract
          (
            betarenaBankContractAddress,
            betarenaBankContractABI,
            modal.getSigner()
          ),
          transactionResponse: Transaction = await contract?.depositToken(cryptoDepositOptionSelect?.contractAddress, targetAmount);
        ;

        // ‚ñì [üêû]
        console.log('transactionResponse', transactionResponse);

        return;
      }
      ,
      (
        ex: unknown
      ): void =>
      {
        errors = true;

        if (ex?.toString()?.includes('ERC20: transfer amount exceeds allowance'))
          // ‚ñì [üêû]
          console.info('‚ùå Invalid ERC20 allowance amount.');
        else if (ex?.toString()?.includes('Error: Internal JSON-RPC error.'))
          // ‚ñì [üêû]
          console.info('‚ùå Incorrect Network Selected.');
        else if (ex?.toString()?.includes('code=CALL_EXCEPTION'))
          console.info('‚ùå ERR :: Incorrect selected chain by client/user');
        else
          // ‚ñì [üêû]
          console.error(`üíÄ Unhandled :: ${ex}`);

        return;
      }
    );

    // ‚ñì CHECK
    // ‚ñì > for errors registered.
    if (errors)
    {
      triggerInvestBox = false;
      stateWidget = 'Error';
      $sessionStore.showDepositModalState = false;
      return;
    }

    // ‚ñì NOTE:
    // ‚ñì > send data for completed user transaction to DB.
    const txDepositData: B_H_TH =
    {
      uid: $userBetarenaSettings?.user?.firebase_user_data?.uid,
      // date: new Date().toISOString(),
      wallet_address_erc20: walletAddress,
      asset: cryptoDepositOptionSelect?.name,
      amount: depositAmount,
      quantity: recieveAmount,
      Gateway: 'cryptocurrency',
      description: mapInvestorData?.get('round')?.values?.current_round,
      type: 'deposit',
      bta_price: 1,
      deposit_wallet_address:
      {
        type: 'Polygon',
        address: walletAddress
      }
    };

    // ‚ñì [üêû]
    console.debug
    (
      `üîπ [var] txDepositData ${JSON.stringify(txDepositData)}`
    );

    await post
    (
      '/api/data/profile',
      txDepositData
    );

    triggerInvestBox = false;
    stateWidget = 'Completed';
    $sessionStore.showDepositModalState = true;

    return;
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  üü• COMPONENT MAIN
   * @description
   *  üì£ Fetch target cryptocurrency prices.
   * @returns { Promise < void > }
   */
  async function getCryptoPrices
  (
  ): Promise < void >
  {
    cryptoPrices = await get
    (
      `/api/coinmarketcap?tickers=USDT,USDC`,
      null,
      true,
      true
    ) as ICoinMarketCapDataMain;

    cryptoPrice = parseFloat(toDecimalFix(cryptoPrices?.data?.[cryptoDepositOptionSelect?.name]?.quote?.USD?.price, 3, true, false)) ?? 0;

    interval1 = setInterval
    (
      async (
      ): Promise < void > =>
      {
        cryptoPrices = await get
        (
          `/api/coinmarketcap?tickers=USDT,USDC`,
          null,
          true,
          true
        ) as ICoinMarketCapDataMain;

        cryptoPrice = parseFloat(toDecimalFix(cryptoPrices?.data?.[cryptoDepositOptionSelect?.name]?.quote?.USD?.price, 3, true, false)) ?? 0;
      }
      ,
      30000
    );

    return;
  }

  // #endregion ‚û§ üõ†Ô∏è METHODS

  // #region ‚û§ üî• REACTIVIY [SVELTE]

  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  // ### NOTE:                                                            ‚óºÔ∏è
  // ### Please add inside 'this' region the 'logic' that should run      ‚óºÔ∏è
  // ### immediately and/or reactively for 'this' .svelte file is ran.    ‚óºÔ∏è
  // ### WARNING:                                                         ‚óºÔ∏è
  // ### ‚ùóÔ∏è Can go out of control.                                        ‚óºÔ∏è
  // ### (a.k.a cause infinite loops and/or cause bottlenecks).           ‚óºÔ∏è
  // ### Please keep very close attention to these methods and            ‚óºÔ∏è
  // ### use them carefully.                                              ‚óºÔ∏è
  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è

  /**
   * @description TODO:
  */
  $:
  if (browser && deepReactListenSignerChange && triggerInvestBox)
  {
    // ### [üêû]
    dlogv2
    (
      `üöè checkpoint [R] ‚û§ if_R_X20`,
      [
        `üîπ [var] ‚û§ deepReactListenSignerChange ${deepReactListenSignerChange}`,
        `üîπ [var] ‚û§ triggerInvestBox ${triggerInvestBox}`,
      ],
      true
    );

    executeContract();
  }

  /**
   * @description TODO:
  */
  $:
  if (depositAmount >= 100000)
  {
    tierDiscountObject.name = 'Platinum';
    tierDiscountObject.icon = icon_platinum;
    tierDiscountObject.discount = 50;
  }
  else if (depositAmount >= 50000)
  {
    tierDiscountObject.name = 'Gold';
    tierDiscountObject.icon = icon_gold;
    tierDiscountObject.discount = 40;
  }
  else if (depositAmount >= 20000)
  {
    tierDiscountObject.name = 'Silver';
    tierDiscountObject.icon = icon_silver;
    tierDiscountObject.discount = 30;
  }
  else if (depositAmount >= 2500)
  {
    tierDiscountObject.name = 'Bronze';
    tierDiscountObject.icon = icon_bronze;
    tierDiscountObject.discount = 20;
  }
  else if (depositAmount < 2500)
  {
    tierDiscountObject.name = null;
    tierDiscountObject.icon = null;
    tierDiscountObject.discount = 0;
  }

  /**
   * @description TODO:
  */
  $:
  {
    // ‚ñì NOTE:
    // ‚ñì > relation between (1) deposit, (2) exchange price, (3) discount to obtain recieveAmount.
    recieveAmount = parseFloat(toDecimalFix(depositAmount / (cryptoPrice * (1 - (tierDiscountObject.discount / 100))), 2));
  }

  /**
   * @description TODO:
  */
  $: if (tokenSearch)
  {
    // ### [üêû]
    dlogv2
    (
      `üöè checkpoint [R] ‚û§ if_R_X2234`,
      [
        `üîπ [var] ‚û§ tokenSearch ${tokenSearch}`,
      ],
      true
    );

    searchToken();
  }
  else if (tokenSearch == '' || tokenSearch == undefined)
  {
    cryptoDepositOptionsSearch = passByValue(cryptoDepositOptions);
  }

  $: if (isNaN(cryptoPrice)) cryptoPrice = 1.00;

  $:
  if (deepReactListenDepositOptionChange || deepReactListenSignerChange)
  {
    // ### [üêû]
    dlog
    (
      `üöè checkpoint [R] ‚û§ IF_X_212`,
      true
    );

    getTokenBalance();
  }

  $:
  if (!deepReactListenSignerChange)
  {
    // ### [üêû]
    dlog
    (
      `üöè checkpoint [R] ‚û§ IF_X_212 [E]`,
      true
    );

    cryptoDepositOptionSelect.userBalance = 0;
  }

  // #endregion ‚û§ üî• REACTIVIY [SVELTE]

  // #region ‚û§ üîÑ LIFECYCLE [SVELTE]

  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  // ### NOTE:                                                            ‚óºÔ∏è
  // ### Please add inside 'this' region the 'logic' that should run      ‚óºÔ∏è
  // ### immediately and as part of the 'lifecycle' of svelteJs,          ‚óºÔ∏è
  // ### as soon as 'this' .svelte file is ran.                           ‚óºÔ∏è
  // ### ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è

  onMount
  (
    async (
    ) =>
    {
      getCryptoPrices();
      addEventListeners();
      resizeAction();
    }
  );

  onDestroy
  (
    () =>
    {
      // @ts-expect-error
      clearInterval(interval1);

      for (const unsubscribe of modalUnsubscribe)
        unsubscribe();
    }
  );

  // #endregion ‚û§ üîÑ LIFECYCLE [SVELTE]

</script>

<!--
‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
### COMPONENT HTML                                                                     ‚óºÔ∏è
### NOTE:                                                                              ‚óºÔ∏è
### use 'CTRL+SPACE' to autocomplete global class=styles                               ‚óºÔ∏è
### NOTE:                                                                              ‚óºÔ∏è
### access custom Betarena Scores VScode Snippets by typing emmet-like abbrev.         ‚óºÔ∏è
‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
-->

<ModalTermsAndConditions />

{#if stateWidget}
  <ModalTxState
    {stateWidget}
    on:closeDropdown={() => stateWidget = null}
    on:closeDropdown={() => $sessionStore.showDepositModalState = false}
  />
{/if}

<form
  id={CNAME}
  class:dark-background-1={$userBetarenaSettings.theme == 'Dark'}
  on:submit|preventDefault={() => executeDeposit()}
>

  <!--
  ‚ñì NOTE:
  ‚ñì > Top Box (Outer)
  -->
  <div
    id="{CNAME}‚Æïtop-row"
  >

    <!--
    ‚ñì NOTE:
    ‚ñì > Top Row
    -->
    <div
      class=
      "
      row-space-out
      "
    >

      <!--
      ‚ñì NOTE:
      ‚ñì > widget title
      -->
      <p
        class=
        "
        s-24
        w-500
        color-black-2
        "
      >
        Invest Box
      </p>

      <!--
      ‚ñì NOTE:
      ‚ñì > Connect Wallet.
      -->
      <button
        type="button"
        class=
        "
        btn-dark
        w-500
        row-space-start
        width-auto
        "
        on:click={() => connectWallet()}
      >
        <p
          class=
          "
          s-14
          color-black-2
          m-r-6
          "
        >
          {shortenWeb3WalletAddress(walletAddress) ?? 'Connect your wallet'}
        </p>

        {#if !walletAddress}
          <img
            id=''
            src={$userBetarenaSettings.theme == 'Dark' ? icon_arrow_right_dark : icon_arrow_right}
            alt=''
            title=''
            loading='lazy'
            width=16
            height=16
          />
        {/if}
      </button>

    </div>

    <!--
    ‚ñì NOTE:
    ‚ñì > Investment Options TEXT.
    -->
    <p
      class=
      "
      s-14
      color-grey
      dark-white-v3
      m-t-15
      "
    >
      Investment options
    </p>

    <!--
    ‚ñì NOTE:
    ‚ñì > Deposit Method.
    -->
    <div
      class=
      "
      m-t-20
      row-space-out
      "
    >

      <!--
      ‚ñì NOTE:
      ‚ñì > Crypto Deposit OPTION.
      -->
      <button
        type="button"
        class=
        "
        btn-hollow
          v4
          v3d
        width-100
        color-black-2
        m-r-12
        w-500
        s-14
        "
        class:btn-active={selectDepositOption == 'crypto'}
        on:click={() => selectDepositOption = 'crypto'}
      >
        Crypto
      </button>

      <!--
      ‚ñì NOTE:
      ‚ñì > Fiat Deposit OPTION.
      -->
      <a
        href="https://buy.stripe.com/7sIeWc72V8Hw33WbIM?client_reference_id=${$userBetarenaSettings?.user?.firebase_user_data?.uid}"
        target="_blank"
        class=
        "
        width-100
        "
      >
        <button
          type="button"
          class=
          "
          btn-hollow
            v4
            v3d
          width-100
          color-black-2
          w-500
          s-14
          "
          class:btn-active={selectDepositOption == 'fiat'}
          on:click={() => selectDepositOption = 'fiat'}
        >
          Fiat
        </button>
      </a>

    </div>

    <!--
    ‚ñì NOTE:
    ‚ñì > Terms & Conditions BOX.
    -->
    <div
      class=
      "
      m-t-20
      row-space-start
      "
    >

      <!-- [üêû] -->
      <!-- {agreeTermsAndConditions} -->

      <!--
      ‚ñì NOTE:
      ‚ñì > Terms & Conditions INPUT.
      -->
      <label
        class=
        "
        m-r-12
        container
        "
      >
        <input
          id=""
          name=""
          type="checkbox"
          class=
          "
          v-1
          cursor-pointer
          "
          required
          bind:checked={agreeTermsAndConditions}
        />

        <span
          class="checkmark"
        >
          {#if agreeTermsAndConditions}
            <img
              id=''
              class=
              "
              box-center
              "
              src={icon_checkbox}
              alt=''
              title=''
              loading='lazy'
            />
          {/if}
        </span>
      </label>

      <!--
      ‚ñì NOTE:
      ‚ñì > Terms & Conditions TEXT.
      -->
      <p
        class=
        "
        s-16
        color-grey
          grey-v1
        "
        on:click={() => $sessionStore.showTermsAndConditions = true}
      >
        I have read the

        <span
          class=
          "
          w-500
          color-black-2
          underline
          cursor-pointer
          "
          on:click={() => alert('clicked terms and conditions')}
        >
          terms
        </span>
        and
        <span
          class=
          "
          w-500
          color-black-2
          underline
          cursor-pointer
          "
          on:click={() => alert('clicked terms and conditions')}
        >
          disclaimers.
        </span>

      </p>

    </div>

  </div>

  <!--
  ‚ñì NOTE:
  ‚ñì > Middle Box (Outer)
  -->
  <div
    id="{CNAME}‚Æïmiddle-row"
  >

    <!--
    ‚ñì NOTE:
    ‚ñì > Deposit Amount
    -->
    <div
      class=
      "
      input-box
      "
    >

      <!--
      ‚ñì NOTE:
      ‚ñì > Deposit Amount BOX
      -->
      <div>

        <!--
        ‚ñì NOTE:
        ‚ñì > Deposit amount TITLE.
        -->
        <p
          class=
          "
          s-16
          w-500
          color-black-2
          m-b-5
          "
        >
          Deposit Amount
        </p>

        <!--
        ‚ñì NOTE:
        ‚ñì > Deposit amount initial.
        -->
        <p
          class=
          "
          s-12
          color-grey
            dark-v1
          "
        >
          First Minimum Deposit
          <span
            class=
            "
            color-black-2
            w-500
            "
          >
            2500 USD
          </span>
          / Max. Deposit
          <span
            class=
            "
            color-black-2
            w-500
            "
          >
            ‚àû
          </span>
        </p>

      </div>

      <!--
      ‚ñì NOTE:
      ‚ñì > Deposit Box.
      -->
      <div
        class=
        "
        row-space-out
        "
      >

        <!--
        ‚ñì NOTE:
        ‚ñì > Deposit Box.
        -->
        <div>

          <!--
          ‚ñì NOTE:
          ‚ñì > Deposit amount INPUT.
          -->
          <input
            type="number"
            step="any"
            placeholder=0
            class=
            "
            s-20
            color-black-2
            amount-input
            w-500
            "
            required
            bind:value={depositAmount}
          />

          <!--
          ‚ñì NOTE:
          ‚ñì > Conversion Rate.
          -->
          <p
            class=
            "
            s-12
            color-grey
              dark-v1
            m-t-5
            "
          >
            <!-- ‚ñì [üêû] -->
            <!-- {console.log(cryptoPrices?.data?.['USDC']?.quote?.USD?.price)} -->
            {depositAmount ?? 0} {cryptoDepositOptionSelect?.name} ‚âà {cryptoPrice} USD
          </p>

        </div>

        <!--
        ‚ñì NOTE:
        ‚ñì > token box (parent)
        -->
        <div>

          <!--
          ‚ñì NOTE:
          ‚ñì > Token.
          -->
          <div
            class=
            "
            row-space-end
            width-auto
            cursor-pointer
            m-b-5
            "
            on:click={() => modalSelectCryptoOption = true}
          >

            <!--
            ‚ñì NOTE:
            ‚ñì > Token Asset Icon.
            -->
            <img
              id=''
              src={cryptoDepositOptionSelect?.icon}
              alt={cryptoDepositOptionSelect?.name}
              title={cryptoDepositOptionSelect?.name}
              loading='lazy'
              width=20
              height=20
              class=
              "
              m-r-6
              "
            />

            <!--
            ‚ñì NOTE:
            ‚ñì > Token Asset Name.
            -->
            <p
              class=
              "
              s-15
              w-500
              color-black-2
              m-r-6
              "
            >
              {cryptoDepositOptionSelect?.name}
            </p>

            <img
              id=''
              src={$userBetarenaSettings.theme == 'Dark' ? icon_arrow_down_dark : icon_arrow_down}
              alt=''
              title=''
              loading='lazy'
              width=16
              height=16
            />

          </div>

          <!--
          ‚ñì NOTE:
          ‚ñì > Token User Balance.
          -->
          <p
            class=
            "
            s-12
            color-black-2
            "
          >
            Balance: {toDecimalFix(cryptoDepositOptionSelect?.userBalance) ?? 0}
          </p>

        </div>

      </div>

    </div>

    <!--
    ‚ñì NOTE:
    ‚ñì > Recieve Amount
    -->
    <div
      class=
      "
      input-box
      "
    >

      <!--
      ‚ñì NOTE:
      ‚ñì > Recieve amount TITLE.
      -->
      <p
        class=
        "
        s-16
        w-500
        color-black-2
        m-b-5
        "
      >
        You will recieve
      </p>

      <!--
      ‚ñì NOTE:
      ‚ñì > Recieve Box.
      -->
      <div
        class=
        "
        row-space-out
        "
      >

        <!--
        ‚ñì NOTE:
        ‚ñì > Recieve amount BOX.
        -->
        <div
        >

          <!--
          ‚ñì NOTE:
          ‚ñì > Recieve amount INPUT.
          -->
          <input
            type="number"
            step="any"
            placeholder=0
            class=
            "
            s-20
            amount-input
            color-black-2
            w-500
            "
            required
            bind:value={recieveAmount}
          />

          <!--
          ‚ñì NOTE:
          ‚ñì > Conversion Rate.
          -->
          <p
            class=
            "
            s-12
            color-grey
              dark-v1
            m-t-5
            "
          >
            {toDecimalFix(1 - (tierDiscountObject.discount / 100))} {cryptoDepositOptionSelect?.name} ‚âà 1.00 BTA
          </p>

        </div>

        <!--
        ‚ñì NOTE:
        ‚ñì > BTA Token.
        -->
        <div
          class=
          "
          row-space-start
          width-auto
          "
        >
          <!--
          ‚ñì NOTE:
          ‚ñì > BTA Asset.
          -->
          <img
            id=''
            src={icon_bta_token}
            alt=''
            title=''
            loading='lazy'
            width=20
            height=20
            class=
            "
            m-r-6
            "
          />

          <!--
          ‚ñì NOTE:
          ‚ñì > BTA Token NAME.
          -->
          <p
            class=
            "
            s-15
            w-500
            color-black-2
            "
          >
            BTA
          </p>

        </div>

      </div>

    </div>

    <!--
    ‚ñì NOTE:
    ‚ñì > Current Tier Discount
    -->
    {#if tierDiscountObject?.name}

      <div
        id="tier-box"
        style=
        "
        {isViewMobile ? 'justify-content: space-between;' : ''}
        "
        class:row-space-out={!isViewMobile}
        class:column-space-start={isViewMobile}
      >
        <!--
        ‚ñì NOTE:
        ‚ñì > current tier TEXT.
        -->
        <p
          class=
          "
          s-16
          w-500
          color-black-2
          no-wrap
          "
        >
          Current Tier Discount
        </p>

        <!--
        ‚ñì NOTE:
        ‚ñì > tier SUB-BOX.
        -->
        <div
          class=
          "
          {!isViewMobile ? 'row-space-start width-auto' : 'row-space-out'}
          "
        >

          <!--
          ‚ñì NOTE:
          ‚ñì > current tier SUB-BOX.
          -->
          <div
            class=
            "
            row-space-start
            width-auto
            m-r-20
            "
          >

            <!--
            ‚ñì NOTE:
            ‚ñì > current tier discount icon IMG.
            -->
            <img
              id=''
              src={tierDiscountObject?.icon}
              alt={tierDiscountObject?.icon}
              title='Discount Tier Asset'
              loading='lazy'
              width=24
              height=24
              class=
              "
              m-r-8
              "
            />

            <!--
            ‚ñì NOTE:
            ‚ñì > current tier discount name TEXT.
            -->
            <p
              class=
              "
              s-16
              w-500
              color-black-2
              "
            >
              {tierDiscountObject?.name}
            </p>

          </div>

          <!--
          ‚ñì NOTE:
          ‚ñì > current tier discount amount NUMBER.
          -->
          <p
            class=
            "
            s-15
            w-500
            color-black-2
            "
          >
            {tierDiscountObject?.discount ?? 0}%
          </p>

        </div>

      </div>

    {/if}

    <!--
    ‚ñì NOTE:
    ‚ñì > Execute Deposit Button
    -->
    <button
      type="submit"
      form="{CNAME}"
      class=
      "
      btn-primary-v2
        btn-shadow-1
      width-100
      m-t-15
      w-500
      s-14
      "
    >
      Buy BTA
    </button>

  </div>

  <!--
  ‚ñì NOTE:
  ‚ñì > Cryptocurrency Deposit Option Select (Outer)
  -->
  {#if modalSelectCryptoOption}

    <!--
    ‚ñì NOTE:
    ‚ñì > Cryptocurrency Background
    -->
    <div
      id="{CNAME}‚Æïmodal-bg-blur"
      in:fade
      on:click={() => modalSelectCryptoOption = false}
    />

    <!--
    ‚ñì NOTE:
    ‚ñì > Cryptocurrency Select
    -->
    <div
      id="select-cryptocurrency"
      in:fly={{ y: 500, duration: 500 }}
      out:fly={{ y: 500, duration: 500 }}
    >

      <!--
      ‚ñì NOTE:
      ‚ñì > Select token TITLE.
      -->
      <div
        id="top-box"
      >

        <!--
        ‚ñì NOTE:
        ‚ñì > Select token TITLE.
        -->
        <p
          class=
          "
          s-20
          w-500
          color-black-2
          m-b-20
          "
        >
          {'Select Crypto Currency'}
        </p>

        <!--
        ‚ñì NOTE:
        ‚ñì > Close vector.
        -->
        <img
          id="close-vector"
          src={$userBetarenaSettings.theme == 'Dark' ? icon_close_dark : icon_close}
          alt="close-svg"
          class=
          "
          cursor-pointer
          "
          on:click={() => modalSelectCryptoOption = false}
          width=14
          height=14
        />

        <!--
        ‚ñì NOTE:
        ‚ñì > Execute Deposit Button
        -->
        <input
          id="token-search"
          placeholder="Search"
          type="text"
          class=
          "
          s-14
          color-black-2
          "
          required
          bind:value={tokenSearch}
        />

      </div>

      <!--
      ‚ñì NOTE:
      ‚ñì > Available ERC-20 options.
      -->
      <div
        id="token-list"
      >
        {#each cryptoDepositOptionsSearch ?? [] as item}

          <!--
          ‚ñì NOTE:
          ‚ñì > Token Row BOX.
          -->
          <div
            class=
            "
            row-space-start
            cursor-pointer
            ‚ñì
            token-row
            "
            style=
            "
            align-items: flex-start;
            "
            on:click={() => cryptoDepositOptionSelect = item}
            on:click={() => modalSelectCryptoOption = false}
          >

            <!--
            ‚ñì NOTE:
            ‚ñì > Token Icon.
            -->
            <img
              id=''
              src={item?.icon}
              alt=''
              title=''
              loading='lazy'
              width=24
              height=24
              class=
              "
              m-r-12
              "
            />

            <!--
            ‚ñì NOTE:
            ‚ñì > Token Icon.
            -->
            <p
              class=
              "
              s-14
              color-black-2
              no-wrap
              ‚ñì
              token-text
              "
            >
              {item?.name ?? ''}

              <br/>

              <span
                class=
                "
                s-12
                color-grey
                  grey-v1
                no-wrap
                "
              >
                {item?.full_name ?? ''}
              </span>
            </p>

          </div>

        {/each}
      </div>

    </div>

  {/if}

</form>

<!--
‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
### COMPONENT STYLE                                                                    ‚óºÔ∏è
### NOTE:                                                                              ‚óºÔ∏è
### auto-fill/auto-complete iniside <style> for var() values by typing/CTRL+SPACE      ‚óºÔ∏è
### NOTE:                                                                              ‚óºÔ∏è
### access custom Betarena Scores CSS VScode Snippets by typing 'style...'             ‚óºÔ∏è
‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
-->

<style>

  #profile‚Æïw‚Æïinvestbox‚Æïmain
  {
    /* üìå position */
    position: relative;
    /* üé® style */
    border-radius: 12px;
    overflow: hidden;
    height: fit-content;
  }

  div#profile‚Æïw‚Æïinvestbox‚Æïmain‚Æïtop-row
  {
    /* üìå position */
    position: relative;
    /* üé® style */
    padding: 20px;
    padding-top: 24px;
    background: var(--white);
    box-shadow: 0px 4px 16px 0px rgba(0, 0, 0, 0.08);
    /* z-index: 10; */
  }

  button.btn-hollow.btn-active
  {
    /* üé® style */
    border: 1px solid var(--primary) !important;
    background: rgba(245, 98, 15, 0.08);
  }

  input[type=checkbox]
  {
    /* üé® style */
    border: none;
    border-radius: 50px;
  }

  div#profile‚Æïw‚Æïinvestbox‚Æïmain‚Æïmiddle-row
  {
    /* üé® style */
    padding: 20px;
    padding-bottom: 32px;
    background: var(--white);
    display: grid;
    gap: 12px;
  }

  div#profile‚Æïw‚Æïinvestbox‚Æïmain‚Æïtier-box
  {
    /* üé® style */
    border-radius: 12px;
  }

  div.input-box
  {
    /* üé® style */
    padding: 20px;
    border-radius: 12px;
    background-color: var(--whitev2);
    min-height: 154px;
    max-height: 154px;
    display: grid;
    align-content: space-between;

  }

  div#tier-box
  {
    /* üé® style */
    border-radius: 12px;
    min-height: 104px;
    max-height: 104px;
    padding: 20px;
    background-color: var(--whitev2);
  }

  input.amount-input
  {
    /* üé® style */
    padding: 0;
    margin: 0;
    border: none;
    width: fit-content;
    max-width: 150px;
    height: fit-content;
  }
  /* Chrome, Safari, Edge, Opera */
  input[type=number].amount-input::-webkit-inner-spin-button,
  input[type=number].amount-input::-webkit-outer-spin-button
  {
    -webkit-appearance: none;
    margin: 0;
  }
  /* Firefox */
  input[type=number].amount-input
  {
    appearance: textfield;
    -moz-appearance: textfield;
  }

  div#select-cryptocurrency
  {
    /* üìå position */
    position: fixed;
    bottom: 0;
    right: 0;
    left: 0;
    /* üé® style */
    border-radius: 12px;
    background: var(--white);
    box-shadow: 0px 4px 16px 0px rgba(0, 0, 0, 0.08);
    padding-bottom: 10px;
  }

  div#select-cryptocurrency div#top-box
  {
    /* üé® style */
    padding: 20px;
    padding-bottom: 12px;
  }

  img#close-vector
  {
		/* üìå position */
		position: absolute;
		top: 20px;
		right: 20px;
		z-index: 400000002;
	}

  /*
  token search input
  */
  div#select-cryptocurrency input#token-search
  {
    /* üé® style */
    background-image: url('/assets/svg/league_list/search.svg');
		background-repeat: no-repeat;
		background-position: 15px 50%;
		background-size: 20px 20px;
		padding: 12px 52px 12px 40px;
    background-color: var(--white-3);
		border: 1px solid transparent;
	}
	div#select-cryptocurrency input#token-search:hover
  {
    /* üé® style */
		border: 1px solid #8c8c8c;
	}
	div#select-cryptocurrency input#token-search:focus
  {
    /* üé® style */
		border: 1px solid #4b4b4b;
	}
	div#select-cryptocurrency input#token-search[placeholder]
  {
    /* üé® style */
		overflow: hidden;
		white-space: nowrap;
		text-overflow: ellipsis;
	}

  /*
  token list
  */
  div#select-cryptocurrency div#token-list
  {
    /* üé® style */
    display: grid;
  }
  div#select-cryptocurrency div#token-list div.token-row
  {
    /* üé® style */
    padding: 8px 20px;
    min-height: 53px;
    max-height: 53px;
  }
  div#select-cryptocurrency div#token-list div.token-row:hover
  {
    /* üé® style */

    background-color: var(--white-3);
  }
  div#select-cryptocurrency div#token-list div.token-row p.token-text
  {
    /* üé® style */
    position: relative;
  }
  div#select-cryptocurrency div#token-list div.token-row p.token-text span
  {
    /* üé® style */
    position: absolute;
  }

  div#profile‚Æïw‚Æïinvestbox‚Æïmain‚Æïmodal-bg-blur
  {
		/* üìå position */
		position: absolute;
		top: 0;
		right: 0;
		left: 0;
		z-index: 0;
		/* üé® style */
		height: 100%;
		width: 100%;
		background: rgba(0, 0, 0, 0.5);
	}

  /*
  ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  ‚óºÔ∏è ‚ö°Ô∏è RESPONSIVNESS       ‚óºÔ∏è
  ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  */

  @media screen
  and (min-width: 575px)
  {
    div#tier-box
    {
      /* üé® style */
      min-height: 64px;
      max-height: 64px;
    }
  }

  @media screen
  and (min-width: 1160px)
  {
    div#select-cryptocurrency
    {
      /* üìå position */
      position: absolute;
    }
  }

  /*
  ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  ‚óºÔ∏è üåí DARK-THEME         ‚óºÔ∏è
  ‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è‚óºÔ∏è
  */

  #profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#profile‚Æïw‚Æïinvestbox‚Æïmain‚Æïtop-row
  {
    /* üé® style */
    background-color: var(--dark-theme-1);
  }

  #profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#profile‚Æïw‚Æïinvestbox‚Æïmain‚Æïmiddle-row
  {
    /* üé® style */
    background-color: var(--dark-theme-1-4-shade);
  }

  #profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div.input-box,
  #profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#tier-box
  {
    /* üé® style */
    background-color: var(--dark-theme);
  }

  #profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#select-cryptocurrency
  {
    /* üé® style */
    background: var(--dark-theme-1-4-shade) !important;
  }

  /* token search input */
  #profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#select-cryptocurrency input#token-search
  {
    /* üé® style */
		background-color: var(--dark-theme-1) !important;
		border: 1px solid transparent;
		color: white;
	}
	#profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#select-cryptocurrency input#token-search:hover
  {
    /* üé® style */
		border: 1px solid var(--dark-theme-1-2-shade);
	}
	#profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#select-cryptocurrency input#token-search:focus
  {
    /* üé® style */
		border: 1px solid var(--grey-shade);
		background-image: url('/assets/svg/league_list/search-white.svg');
	}

  /* token row */
  #profile‚Æïw‚Æïinvestbox‚Æïmain.dark-background-1 div#token-list div.token-row:hover
  {
    /* üé® style */
    background-color: var(--dark-theme-1);
  }

</style>
