<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ High Order Component Overview                                                    â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ Version Svelte Format :|: V.8.0 [locked]                                       â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Svelte Component JS/TS                                                           â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ HINT: â”‚ Access snippets for '<script> [..] </script>' those found in           â”‚
â”‚         â”‚ '.vscode/snippets.code-snippets' via intellisense using 'doc'          â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<script lang="ts">

  // #region â¤ ğŸ“¦ Package Imports

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'imports' that are required        â”‚
  // â”‚ by 'this' .svelte file is ran.                                         â”‚
  // â”‚ IMPORTANT                                                              â”‚
  // â”‚ Please, structure the imports as follows:                              â”‚
  // â”‚ 1. svelte/sveltekit imports                                            â”‚
  // â”‚ 2. project-internal files and logic                                    â”‚
  // â”‚ 3. component import(s)                                                 â”‚
  // â”‚ 4. assets import(s)                                                    â”‚
  // â”‚ 5. type(s) imports(s)                                                  â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  import { page } from '$app/stores';
  import TxStatusPill from '$lib/components/shared/Tx-Status-Pill.svelte';

  import { toZeroPrefixDateStr } from '$lib/utils/dates.js';

  import icon_arrow_down from '../assets/arrow-down.svg';
  import icon_arrow_up from '../assets/arrow-up.svg';
  import icon_bronze from '../assets/price-tier/icon-bta-bronze.svg';
  import icon_gold from '../assets/price-tier/icon-bta-gold.svg';
  import icon_platinum from '../assets/price-tier/icon-bta-platinum.svg';
  import icon_silver from '../assets/price-tier/icon-bta-silver.svg';

	import TranslationText from '$lib/components/misc/Translation-Text.svelte';

	import type { KeypairInvestorPresaleMain, PublicTransactionHistoryMain } from '@betarena/scores-lib/types/_AUTO-HASURA-2_.js';
	import type { IPresaleTier } from '@betarena/scores-lib/types/_ENUMS_.js';
	import type { B_H_KEYP_Tier } from '@betarena/scores-lib/types/_HASURA_.js';
	import type { IProfileTrs } from '@betarena/scores-lib/types/types.profile.js';

  // #endregion â¤ ğŸ“¦ Package Imports

  // #region â¤ ğŸ“Œ VARIABLES

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'variables' that are to be         â”‚
  // â”‚ and are expected to be used by 'this' .svelte file / component.        â”‚
  // â”‚ IMPORTANT                                                              â”‚
  // â”‚ Please, structure the imports as follows:                              â”‚
  // â”‚ 1. export const / let [..]                                             â”‚
  // â”‚ 2. const [..]                                                          â”‚
  // â”‚ 3. let [..]                                                            â”‚
  // â”‚ 4. $: [..]                                                             â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  export let
    /**
     * @augments PublicTransactionHistoryMain
     */
    data: PublicTransactionHistoryMain
    /**
     * @description
     *  ğŸ“£ Target `tier` data represented as `map`.
     */
    , tierDataMap: Map < IPresaleTier, KeypairInvestorPresaleMain >
    /**
     * @description
     *  ğŸ“£ threshold start + state for ğŸ“± MOBILE
     */ // eslint-disable-next-line no-unused-vars
    , VIEWPORT_MOBILE_INIT: [ number, boolean ] = [ 575, true ]
  ;

  const
    /**
     * @description
     *  ğŸ“£ `this` component **main** `id` and `data-testid` prefix.
     */ // eslint-disable-next-line no-unused-vars
    CNAME: string = 'profileâ®•wâ®•invest-history-rowâ®•main'
  ;

  let
    /**
     * @description
     *  ğŸ“£ Wether extra information is toggled (mobile only).
     */
    isTxExtraInfo: boolean = false
    /**
     * @description
     *  ğŸ“£ Properties to be shown in mobile view.
     */
    , mobileProps: string[]
      = [
        'discount'
        , 'investment'
        , 'tokens'
        , 'price'
        , 'description'
        , 'tier'
      ]
    /**
     * @description
     *  ğŸ“£ Target `icon` asset for _this_ transaction.
     */
    , targetTxTierIcon: string = selectIcon(data.tier ?? 'NaN')
  ;

  $: profileTrs = $page.data.RESPONSE_PROFILE_DATA as IProfileTrs | null | undefined;

  // #endregion â¤ ğŸ“Œ VARIABLES

  // #region â¤ ğŸ› ï¸ METHODS

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'methods' that are to be           â”‚
  // â”‚ and are expected to be used by 'this' .svelte file / component.        â”‚
  // â”‚ IMPORTANT                                                              â”‚
  // â”‚ Please, structure the imports as follows:                              â”‚
  // â”‚ 1. function (..)                                                       â”‚
  // â”‚ 2. async function (..)                                                 â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  /**
   * @author
   *  @migbash
   * @summary
   *  ğŸŸ¦ HELPER
   * @description
   *  ğŸ“£ Assign target icon for target visible option.
   * @param { string } target
   *  ğŸ’  Target `tier` selected.
   * @return { string }
   *  ğŸ“¤ Target `tier icon`.
   */
  function selectIcon
  (
    target: B_H_KEYP_Tier
  ): string
  {
    if (target == 'bronze')
      return icon_bronze;
    else if (target == 'silver')
      return icon_silver;
    else if (target == 'gold')
      return icon_gold;
    else if (target == 'platinum')
      return icon_platinum;
    else
      return '';
  }

  // #endregion â¤ ğŸ› ï¸ METHODS

</script>

<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Svelte Component HTML                                                            â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ HINT: â”‚ Use 'Ctrl + Space' to autocomplete global class=styles, dynamically    â”‚
â”‚         â”‚ imported from './static/app.css'                                       â”‚
â”‚ â¤ HINT: â”‚ access custom Betarena Scores VScode Snippets by typing emmet-like     â”‚
â”‚         â”‚ abbrev.                                                                â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<tr
  class=
  "
  {CNAME}
  "
  class:extra-info={isTxExtraInfo && VIEWPORT_MOBILE_INIT[1]}
  on:click={() => {return isTxExtraInfo = !isTxExtraInfo}}
>

  <!--
  â–“ NOTE:
  â–“ > transaction execution date.
  -->
  <td>
    <p>
      {
        new Date(data.date ?? '').getDate()
        + '/'
        + toZeroPrefixDateStr(new Date(data.date ?? '').getMonth() + 1)
        + '/'
        + (new Date(data.date ?? '').getFullYear()).toString().substr(-2)
      }
    </p>
  </td>

  <!--
  â–“ NOTE:
  â–“ > transaction execution type.
  -->
  <td>
    <div
      class=
      "
      column-start-grid-start
      "
    >
      <p>
        {data.type ?? '-'}
      </p>
      {#if !VIEWPORT_MOBILE_INIT[1]}
        <span
          class=
          "
          s-12
          color-grey
          "
        >
          {data.description ?? '-'}
        </span>
      {/if}
    </div>
  </td>

  <!--
  â–“ NOTE:
  â–“ > ğŸ’» TABLET ğŸ–¥ï¸ LAPTOP
  -->
  {#if !VIEWPORT_MOBILE_INIT[1]}

    <!--
    â–“ NOTE:
    â–“ > transaction execution tier.
    -->
    <td>
      {#if data.tier != null && data.tier != 'NaN'}
        <div
          class=
          "
          row-space-start
          "
        >
          <!--
          â–“ NOTE:
          â–“ > transaction tier icon.
          -->
          <img
            id=''
            src='{targetTxTierIcon}'
            alt=''
            title=''
            loading='lazy'
            width=24
            height=24
            class=
            "
            m-r-8
            "
          />

          <!--
          â–“ NOTE:
          â–“ > transaction tier name tag.
          -->
          <p
            class=
            "
            capitalize
            "
          >
            {data.tier}
          </p>

        </div>
      {:else}
        <p>
          -
        </p>
      {/if}
    </td>

    <!--
    â–“ NOTE:
    â–“ > discount
    -->
    <td>
      <p>
        {tierDataMap.get(data.tier ?? 'NaN')?.data?.discount_percentage}%
      </p>
    </td>

    <!--
    â–“ NOTE:
    â–“ > investment amount
    -->
    <td>
      <p>
        ${data.quantity ?? '-'}
      </p>
    </td>

    <!--
    â–“ NOTE:
    â–“ > investment tokens amount
    -->
    <td>
      <p>
        {data.amount ?? '-'}
      </p>
    </td>

    <!--
    â–“ NOTE:
    â–“ > investment BTA price
    -->
    <td>
      <p>
        ${data.bta_price ?? '-'}
      </p>
    </td>

  {/if}

  <!--
  â–“ NOTE:
  â–“ > investment status + dropdown for ğŸ“± MOBILE
  -->
  <td>
    <div
      class=
      "
      row-space-end
      "
    >
      <TxStatusPill
        txStatus={data.status}
        trsStatusTerms={profileTrs?.tx?.status}
      />

      {#if VIEWPORT_MOBILE_INIT[1]}
        <img
          src={isTxExtraInfo ? icon_arrow_up : icon_arrow_down}
          alt={isTxExtraInfo ? 'icon_arrow_up' : 'icon_arrow_down'}
          class=
          "
          cursor-pointer
          m-l-8
          "
          style=
          "
          float: right;
          "
        />
      {/if}

    </div>
  </td>

  <!--
  â–“ NOTE:
  â–“ > transaction ğŸ“± MOBILE layout
  -->
  {#if isTxExtraInfo && VIEWPORT_MOBILE_INIT[1]}

    <div
      class=
      "
      extra-information
      "
    >
      {#each mobileProps as item}

        <!--
        â–“ NOTE:
        â–“ > target transaction further data row.
        -->
        <div
          class=
          "
          m-b-8
          row-space-out
          "
        >

          <!--
          â–“ NOTE:
          â–“ > target transaction property title.
          -->
          <p
            class=
            "
            s-12
            color-grey
            "
          >
            {#if item == 'discount'}
              <TranslationText
                key={'profile/investor/invest-history/row/discount'}
                text={profileTrs?.investor?.investment_details.discount}
                fallback={'Discount'}
              />
            {:else if item == 'investment'}
              <TranslationText
                key={'profile/investor/invest-history/row/investment'}
                text={profileTrs?.investor?.investment_details.investment}
                fallback={'Investment'}
              />
            {:else if item == 'tokens'}
              <TranslationText
                key={'profile/investor/invest-history/row/tokens'}
                text={profileTrs?.investor?.investment_details.tokens}
                fallback={'Tokens'}
              />
            {:else if item == 'price'}
              <TranslationText
                key={'profile/investor/invest-history/row/price'}
                text={profileTrs?.investor?.investment_details.price}
                fallback={'Price'}
              />
            {:else if item == 'description'}
              <TranslationText
                key={'profile/investor/invest-history/row/description'}
                text={null}
                fallback={'Description'}
              />
            {:else if item == 'tier'}
              <TranslationText
                key={'profile/investor/invest-history/row/tire'}
                text={profileTrs?.investor?.investment_details.tier}
                fallback={'Tier'}
              />
            {/if}
          </p>

          <!--
          â–“ NOTE:
          â–“ > target transaction property value.
          -->
          <p
            class=
            "
            s-14
            color-black-2
            "
          >
            {#if item == 'discount'}
              {tierDataMap.get(data.tier ?? 'NaN')?.data?.discount_percentage}%
            {:else if item == 'investment'}
              ${data.quantity ?? '-'}
            {:else if item == 'tokens'}
              {data.amount ?? '-'}
            {:else if item == 'price'}
              ${data.bta_price ?? '-'}
            {:else if item == 'description'}
              {data.description ?? '-'}
            {:else if item == 'tier'}
              {#if data.tier != null && data.tier != 'NaN'}
                <div
                  class=
                  "
                  row-space-start
                  "
                >
                  <!--
                  â–“ NOTE:
                  â–“ > transaction tier icon.
                  -->
                  <img
                    id=''
                    src='{targetTxTierIcon}'
                    alt=''
                    title=''
                    loading='lazy'
                    width=24
                    height=24
                    class=
                    "
                    m-r-8
                    "
                  />

                  <!--
                  â–“ NOTE:
                  â–“ > transaction tier name tag.
                  -->
                  <p
                    class=
                    "
                    capitalize
                    "
                  >
                    {data.tier}
                  </p>

                </div>
              {:else}
                <p>
                  -
                </p>
              {/if}
            {/if}
          </p>

        </div>

      {/each}
    </div>

  {/if}

</tr>

<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Svelte Component CSS/SCSS                                                        â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ HINT: â”‚ auto-fill/auto-complete iniside <style> for var()                      â”‚
â”‚         â”‚ values by typing/CTRL+SPACE                                            â”‚
â”‚ â¤ HINT: â”‚ access custom Betarena Scores CSS VScode Snippets by typing 'style...' â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<style lang="scss">

  // â–“ IMPORTANT
  // â–“ > Controlled By Parent

</style>
