<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ“Œ High Order Overview                                                           â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ Code Format   // V.8.0                                                         â”‚
â”‚ â¤ Status        // ğŸ”’ LOCKED                                                     â”‚
â”‚ â¤ Author(s)     // @migbash                                                      â”‚
â”‚ â¤ Maintainer(s) // @migbash                                                      â”‚
â”‚ â¤ Created on    // <date-created>                                                â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ ğŸ“ Description                                                                   â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ BETARENA (Module)
â”‚ |: Scores Main Layout Component
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸŸ¦ Svelte Component JS/TS                                                        â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ HINT: â”‚ Access snippets for '<script> [..] </script>' those found in           â”‚
â”‚         â”‚ '.vscode/snippets.code-snippets' via intellisense using 'doc'          â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<script lang="ts">

  // #region â¤ ğŸ“¦ Package Imports

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'imports' that are required        â”‚
  // â”‚ by 'this' .svelte file is ran.                                         â”‚
  // â”‚ IMPORTANT                                                              â”‚
  // â”‚ Please, structure the imports as follows:                              â”‚
  // â”‚ 1. svelte/sveltekit imports                                            â”‚
  // â”‚ 2. project-internal files and logic                                    â”‚
  // â”‚ 3. component import(s)                                                 â”‚
  // â”‚ 4. assets import(s)                                                    â”‚
  // â”‚ 5. type(s) imports(s)                                                  â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  import { browser } from '$app/environment';
  import { afterNavigate, beforeNavigate } from '$app/navigation';
  import { page } from '$app/stores';
  import { onMount } from 'svelte';

  import * as Sentry from '@sentry/sveltekit';

  import { post } from '$lib/api/utils.js';
  import
    {
      routeIdContent,
      routeIdPageCompetitions,
      routeIdPageProfile,
      routeIdPageProfileArticleCreation,
      routeIdPageProfileEditArticle,
      routeIdPageProfilePublication,
      routeIdScores,
    } from '$lib/constants/paths.js';
  import { scoresAdminStore } from '$lib/store/admin.js';
  import sessionStore from '$lib/store/session.js';
  import userBetarenaSettings from '$lib/store/user-settings.js';
  import { dlog, dlogv2 } from '$lib/utils/debug';
  import { mainDeepLinkCheck } from '$lib/utils/deeplink.js';
  import { isPWA, viewportChangeV2 } from '$lib/utils/device.js';
  import { setUserGeoLocation } from '$lib/utils/geo.js';
  import { initializeTopLevelConsoleController } from '$lib/utils/subscribtion.js';

  import AuthMain from '$lib/components/_main_/auth/Widget.svelte';
  import FooterWidget from '$lib/components/_main_/footer/v2/Footer.Widget.svelte';
  import HeaderRedesigned from '$lib/components/_main_/header_redisigned/HeaderRedesigned.svelte';
  import MobileMenu from '$lib/components/_main_/mobile-menu/MobileMenu.svelte';
  import SplashScreen from '$lib/components/misc/Splash-Screen.svelte';
  import DevInfoBox from '$lib/components/misc/admin/Dev-Info-Box.svelte';
  import ModalError from '$lib/components/misc/modal/Modal-Error.svelte';
  import ModalMain from '$lib/components/misc/modal/ModalMain.svelte';
  import ToastAuth from '$lib/components/misc/toast/Toast-Auth/Toast-Auth.svelte';
  import InfoMessages from '$lib/components/ui/infomessages/InfoMessages.svelte';

  import type { B_NAV_T } from '@betarena/scores-lib/types/navbar.js';

  // import '@betarena/ad-engine';
  // import WidgetAdEngine from '@betarena/ad-engine/src/lib/Widget-AdEngine.svelte';
  import WidgetAdEngine from '@betarena/ad-engine';

  // â•­â”€â”€â”€â”€â”€
  // â”‚ WARNING:
  // â”‚ Disable, if Dynamic Import is Enabled.
  // â•°â”€â”€â”€â”€â”€
  // import OfflineAlert from '$lib/components/Offline-Alert.svelte';
  // import PlatformAlert from '$lib/components/Platform-Alert.svelte';
  // import EmailSubscribe from '$lib/components/Email-Subscribe.svelte';

  // â•­â”€â”€â”€â”€â”€
  // â”‚ NOTE:
  // â”‚ moved to static/
  // â•°â”€â”€â”€â”€â”€
  // import '../app.css';

  // #endregion â¤ ğŸ“¦ Package Imports

  // #region â¤ ğŸ“Œ VARIABLES

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'variables' that are to be         â”‚
  // â”‚ and are expected to be used by 'this' .svelte file / component.        â”‚
  // â”‚ IMPORTANT                                                              â”‚
  // â”‚ Please, structure the imports as follows:                              â”‚
  // â”‚ 1. export const / let [..]                                             â”‚
  // â”‚ 2. const [..]                                                          â”‚
  // â”‚ 3. let [..]                                                            â”‚
  // â”‚ 4. $: [..]                                                             â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  /**
   * @description
   *  ğŸ“£ Component `Type`.
   */
  type IDynamicComponentMap =
    | 'OfflineAlertDynamic'
    | 'PlatformAlertDynamic'
    | 'EmailSubscribeDynamic'
  ;

  const
    /**
     * @description
     *  ğŸ“£ Dynamic import variable condition
     */
    useDynamicImport = true,
    /**
     * @description
     *  ğŸ“£ threshold start + state for ğŸ“± MOBILE
     */ // eslint-disable-next-line no-unused-vars
    VIEWPORT_MOBILE_INIT: [number, boolean] = [575, true],
    /**
     * @description
     *  ğŸ“£ threshold start + state for ğŸ’» TABLET
     */ // eslint-disable-next-line no-unused-vars
    VIEWPORT_TABLET_INIT: [number, boolean] = [1160, true],
    /**
     * @description
     *  ğŸ“£ Holds target `component(s)` of dynamic nature.
     */
    dynamicComponentMap = new Map<IDynamicComponentMap, any>()
  ;

  $: ({ currentPageRouteId, currentActiveModal, currentActiveToast, globalState, serverLang } = { ...$sessionStore });
  $: ({ theme } = { ...$userBetarenaSettings });
  $: ({ username, lang, competition_number } = { ...$userBetarenaSettings.user?.scores_user_data });
  $: ({ uid, email } = { ...$userBetarenaSettings.user?.firebase_user_data });

  $: ispwa = globalState.has('IsPWA');

  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition
  $: navbarTranslationData = ($page.data.B_NAV_T ?? {}) as
    | B_NAV_T
    | null
    | undefined
  ;
  $: deepReactListenStore1 = JSON.stringify($sessionStore);
  $: deepReactListenStore2 = JSON.stringify($userBetarenaSettings);

  $: $sessionStore.serverLang = $page.data.langParam as string;
  $: if (browser) $sessionStore.page = $page;
  $: isInitliazed = false;

  $: [VIEWPORT_MOBILE_INIT[1], VIEWPORT_TABLET_INIT[1]]
    = viewportChangeV2
    (
      $sessionStore.windowWidth,
      VIEWPORT_MOBILE_INIT[0],
      VIEWPORT_TABLET_INIT[0]
    )
  ;

  onMount(() => {
    $sessionStore.deviceType       = $page.data.deviceType as 'mobile' | 'tablet' | 'desktop';
    $sessionStore.fixturesTodayNum = navbarTranslationData?.scores_header_fixtures_information?.football ?? 0;
    $sessionStore.userAgent        = $page.data.userAgent as string ?? navigator.userAgent;
  })


  // #endregion â¤ ğŸ“Œ VARIABLES

  // #region â¤ ğŸ› ï¸ METHODS

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'methods' that are to be           â”‚
  // â”‚ and are expected to be used by 'this' .svelte file / component.        â”‚
  // â”‚ IMPORTANT                                                              â”‚
  // â”‚ Please, structure the imports as follows:                              â”‚
  // â”‚ 1. function (..)                                                       â”‚
  // â”‚ 2. async function (..)                                                 â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  /**
   * @author
   *  @migbash
   * @summary
   *  [ğŸ]
   * @description
   *  ğŸ“£ Debug Helper
   * @param reactDebug
   */
  function _DEBUG_
  (
    reactDebug: 'Option1' | 'Option2' | 'Option3' | 'Option4'
  ): void
  {
    const
      /**
       * @description
       */
      prefix: string = 'ğŸš checkpoint [R] â¤ src/routes/(scores)/layout.svelte'
    ;
    // [ğŸ]
    if (reactDebug == 'Option1')
      dlog(`${prefix} if_COD_1`, true);
    else if (reactDebug == 'Option2')
      dlog(`${prefix} if_COD_2`, true);
    else if (reactDebug == 'Option3')
      dlog(`${prefix} if_COD_3`, true);
    else
      dlog(`${prefix} if_R_CS43`, true);
    return;
  }

  /**
   * @author
   *  @migbash
   * @summary
   *  ğŸŸ¦ HELPER
   * @description
   *  ğŸ“£ Updates **Betarena User** for their `Firestore` and `CRISP` data.
   * @return { Promise < void > }
   */
  async function updateFirestoreAndCrisp
  (
  ): Promise < void >
  {
    if (!browser || $userBetarenaSettings.user == undefined)
      return;
    ;

    await post
    (
      `${import.meta.env.VITE_FIREBASE_FUNCTIONS_ORIGIN}${import.meta.env.VITE_FIREBASE_FUNCTIONS_F_1}`,
      {
        user_uids: [$userBetarenaSettings.user.firebase_user_data?.uid],
      }
    );

    return;
  }

  // #endregion â¤ ğŸ› ï¸ METHODS

  // #region â¤ ğŸ”¥ REACTIVIY [SVELTE]

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'logic' that should run            â”‚
  // â”‚ immediately and/or reactively for 'this' .svelte file is ran.          â”‚
  // â”‚ WARNING:                                                               â”‚
  // â”‚ â—ï¸ Can go out of control.                                              â”‚
  // â”‚ (a.k.a cause infinite loops and/or cause bottlenecks).                 â”‚
  // â”‚ Please keep very close attention to these methods and                  â”‚
  // â”‚ use them carefully.                                                    â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  // â•­â”€â”€â”€â”€â”€
  // â”‚ > ğŸ”¥ Instant critical data initialization.
  // â•°â”€â”€â”€â”€â”€
  $: if (browser && !isInitliazed)
  {
    _DEBUG_('Option1');
    isInitliazed = true;
    userBetarenaSettings.useLocalStorage(serverLang);
    scoresAdminStore.useLocalStorage();
    mainDeepLinkCheck();
  }

  // â•­â”€â”€â”€â”€â”€
  // â”‚ NOTE: CRITICAL
  // â”‚ â”‚: Hijack the 'console' object.
  // â•°â”€â”€â”€â”€â”€
  $: if (browser && document)
    initializeTopLevelConsoleController();
  ;

  // â•­â”€â”€â”€â”€â”€
  // â”‚ > ğŸ”¥ (3rd Party) Intercom Logic [show/hide]
  // â•°â”€â”€â”€â”€â”€
  // $: if (
  //   (browser && currentPageRouteId == "ProfilePage") ||
  //   currentPageRouteId == "CompetitionPage"
  // ) {
  //   const intercom: HTMLElement = document.getElementsByClassName(
  //     "intercom-lightweight-app"
  //   )[0] as unknown as HTMLElement;
  //   if (intercom != undefined) intercom.style.display = "unset";
  // } else if (browser && !currentPageRouteId) {
  //   const intercom: HTMLElement = document.getElementsByClassName(
  //     "intercom-lightweight-app"
  //   )[0] as unknown as HTMLElement;
  //   if (intercom != undefined) intercom.style.display = "none";
  // }
  $: if (browser && $page.route.id == routeIdPageProfile)
  {
    const
      /**
       * @description
       */
      intercom: HTMLElement = document.getElementsByClassName('intercom-lightweight-app')[0] as unknown as HTMLElement
    ;

    if (intercom != undefined)
      intercom.style.display = 'unset';
    ;
  }
  else if (browser)
  {
    const
      /**
       * @description
       */
      intercom: HTMLElement = document.getElementsByClassName('intercom-lightweight-app')[0] as unknown as HTMLElement
    ;

    if (intercom != undefined)
      intercom.style.display = 'none';
    ;
  }

  // â•­â”€â”€â”€â”€â”€
  // â”‚ > ğŸ”¥ (3rd Party) Intercom Data Persistance [show/hide]
  // â•°â”€â”€â”€â”€â”€
  $: if (browser && (deepReactListenStore1 || deepReactListenStore2))
  {
    _DEBUG_('Option4');
    window.intercomSettings = {
      api_base: 'https://api-iam.intercom.io',
      app_id: 'yz9qn6p3',
      name: username ?? '',
      email: email ?? `${uid}-unkown@gmail.com`,
      uid,
      lang: lang ?? 'en',
      competition_number: competition_number ?? 0,
    };

    // [ğŸ]
    Sentry.setContext
    (
      'ğŸ“¸ Data',
      {
        ...userBetarenaSettings.extractUserDataSnapshot(),
      }
    );
  }

  $: if (browser)
    window.Intercom
    (
      'update',
      {
        hide_default_launcher: currentPageRouteId != 'ProfilePage',
      }
    );
  ;

  // #endregion â¤ ğŸ”¥ REACTIVIY [SVELTE]

  // #region â¤ ğŸ”„ LIFECYCLE [SVELTE]

  // â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  // â”‚ NOTE:                                                                  â”‚
  // â”‚ Please add inside 'this' region the 'logic' that should run            â”‚
  // â”‚ immediately and as part of the 'lifecycle' of svelteJs,                â”‚
  // â”‚ as soon as 'this' .svelte file is ran.                                 â”‚
  // â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  // beforeNavigate
  // (
  //   async (): Promise<void> =>
  //   {
  //     if (!browser) return;

  //     // â•­â”€â”€â”€â”€â”€
  //     // â”‚ NOTE: IMPORTANT
  //     // â”‚ |: Resetting the `live_odds_fixture_target` to `null`.
  //     // â•°â”€â”€â”€â”€â”€
  //     $sessionStore.live_odds_fixture_target = null;

  //     /*
  //       await firebaseAppDelete();
  //       for (const iterator of $sessionStore?.firebaseListeners ?? [])
  //         iterator();
  //       $sessionStore.firebaseListeners = []
  //       for (const iterator of $sessionStore?.grapqhQlWebSockets ?? [])
  //         iterator();
  //       $sessionStore.grapqhQlWebSockets = []
  //     */

  //     return;
  //   }
  // );

  onMount
  (
    async (
    ): Promise < void > =>
    {
      // initSentry();

      // â•­â”€â”€â”€â”€â”€
      // â”‚ NOTE:
      // â”‚ |: Dynamic Import Logic
      // â•°â”€â”€â”€â”€â”€
      if (useDynamicImport)
      {
        dynamicComponentMap.set
        (
          'OfflineAlertDynamic',
          (
            await import
            (
              '$lib/components/misc/banner/Banner-Offline-Alert.svelte'
            )
          ).default
        );

        dynamicComponentMap.set
        (
          'PlatformAlertDynamic',
          (
            await import
            (
              '$lib/components/misc/banner/Banner-Offline-Alert.svelte'
            )
          ).default
        );

        dynamicComponentMap.set
        (
          'EmailSubscribeDynamic',
          (
            await import
            (
              '$lib/components/misc/modal/Modal-Email-Subscribe.svelte'
            )
          ).default
        );
      }

      // â•­â”€â”€â”€â”€â”€
      // â”‚ NOTE: IMPORTANT
      // â”‚ â¤ |: Set initial values of 'windowWidth'.
      // â•°â”€â”€â”€â”€â”€
      sessionStore.updateData
      (
        [
          [
            'windowWidth', document.documentElement.clientWidth
          ]
        ]
      );

      // â•­â”€â”€â”€â”€â”€
      // â”‚ NOTE: IMPORTANT
      // â”‚ |: Check if the current device is a PWA.
      // â•°â”€â”€â”€â”€â”€
      if (isPWA())
        $sessionStore.globalState.add('IsPWA');
      else
        $sessionStore.globalState.delete('IsPWA');
      ;

      setUserGeoLocation(navbarTranslationData!);

      const
        /**
         * @description
         */
        adminSet = $page.url.searchParams.get('admin')
      ;

      if (adminSet)
        scoresAdminStore.toggleAdminState(adminSet == 'true' ? true : false);
      ;

      return;
    }
  );

  onMount
  (
    () =>
    {
      if ('serviceWorker' in navigator)
        navigator.serviceWorker
          .register('/progressier.js')
          .then
          (
            (
              registration
            ) =>
            {
              // [ğŸ]
              // eslint-disable-next-line no-console
              console.log
              (
                'Service Worker registered with scope:',
                registration.scope
              );
            }
          )
          .catch
          (
            (
              error
            ) =>
            {
              // [ğŸ]
              // eslint-disable-next-line no-console
              console.error
              (
                'Service Worker registration failed:',
                error
              );
            }
          );
      ;
    }
  );

  afterNavigate
  (
    async (
      e
    ): Promise < void > =>
    {
      if (!browser) return;

      sessionStore.updateData
      (
        [
          [
            'routeId', $page.route.id
          ]
        ]
      );

      // [ğŸ]
      dlogv2
      (
        'ğŸš checkpoint â¤ src/routes/+layout.svelte afterNavigate(..)',
        [`ğŸ”¹ [var] â¤ e.from :|: ${JSON.stringify(e)}`],
        true
      );

      return;
    }
  );

  // #endregion â¤ ğŸ”„ LIFECYCLE [SVELTE]

</script>

<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ’‰ Svelte Injection Tags                                                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<svelte:head>
  <!--
  HELPDESK PLUGIN
  -->

  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </script> -->
  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </script> -->
  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </script> -->
  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </script> -->
  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </script> -->
  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </!-->
  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </!-->
  <!-- <script type="text/javascript">
      window.$crisp=[];
      window.CRISP_WEBSITE_ID="cb59b31a-b48f-42d5-a24b-e4cf5bac0222";
      (function()
      {
        d=document;
        s=d.createElement("script");
        s.src="https://client.crisp.chat/l.js";
        s.async=1;
        d.getElementsByTagName("head")[0].appendChild(s);
      }
      )();
    </!-->

  <script>
    // We pre-filled your app ID in the widget URL: 'https://widget.intercom.io/widget/yz9qn6p3'
    (function () {
      var w = window;
      var ic = w.Intercom;
      if (typeof ic === "function") {
        ic("reattach_activator");
        ic("update", w.intercomSettings);
      } else {
        var d = document;
        var i = function () {
          i.c(arguments);
        };
        i.q = [];
        i.c = function (args) {
          i.q.push(args);
        };
        w.Intercom = i;
        var l = function () {
          var s = d.createElement("script");
          s.type = "text/javascript";
          s.async = true;
          s.src = "https://widget.intercom.io/widget/yz9qn6p3";
          var x = d.getElementsByTagName("script")[0];
          x.parentNode.insertBefore(s, x);
        };
        if (document.readyState === "complete") {
          l();
        } else if (w.attachEvent) {
          w.attachEvent("onload", l);
        } else {
          w.addEventListener("load", l, false);
        }
      }
    })();
  </script>
</svelte:head>

<svelte:document
  on:visibilitychange=
  {
    () =>
    {
      if (!document.hidden)
      {
        // [ğŸ]
        dlog('ğŸ”µ user is active', true);
        $sessionStore.isUserActive = true;
        updateFirestoreAndCrisp();
        return;
      }
      $sessionStore.isUserActive = false;
      return;
    }
  }
/>

<svelte:window
  on:resize=
  {
    () =>
    {
      sessionStore.updateData
      (
        [
          [
            'windowWidth',
            document.documentElement.clientWidth
          ],
        ]
      );
      if (isPWA())
        $sessionStore.globalState.add('IsPWA');
      else
        $sessionStore.globalState.delete('IsPWA');
      return;
    }
  }
/>

<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ’  Svelte Component HTML                                                         â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ HINT: â”‚ Use 'Ctrl + Space' to autocomplete global class=styles, dynamically    â”‚
â”‚         â”‚ imported from './static/app.css'                                       â”‚
â”‚ â¤ HINT: â”‚ access custom Betarena Scores VScode Snippets by typing emmet-like     â”‚
â”‚         â”‚ abbrev.                                                                â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<div
  class="app-wrapper"
  id="app-root-layout"
  class:dark-mode={theme == 'Dark'}
  class:light-mode={theme == 'Light'}
  class:page-content={$page.route.id === routeIdContent}
  data-page-id={currentPageRouteId}
  data-mode={ispwa ? 'pwa' : 'web'}
>
  {#key $page.route.id}
    <WidgetAdEngine
      authorId={$page.data.dataArticle?.author?.id}
      authorArticleTagIds={$page.data.dataArticle?.article?.tags}
      isDarkTheme={theme == 'Dark'}
      strTranslationTarget={lang ?? 'en'}
    />
  {/key}

  <SplashScreen />

  {#if currentActiveModal == 'Auth_Modal'}
    <AuthMain />
  {/if}

  {#if currentActiveToast != null}
    <ToastAuth />
  {/if}

  {#if $scoresAdminStore.admin}
    <DevInfoBox />
  {/if}

  {#if currentActiveModal == 'GeneralPlatform_Error'}
    <ModalError />
  {/if}

  {#if useDynamicImport}
    <svelte:component this={dynamicComponentMap.get('OfflineAlertDynamic')} />
  {:else}
    <!-- <OfflineAlert /> -->
  {/if}

  {#if useDynamicImport}
    <svelte:component this={dynamicComponentMap.get('PlatformAlertDynamic')} />
  {:else}
    <!-- <PlatformAlert /> -->
  {/if}

  {#if useDynamicImport}
    <svelte:component this={dynamicComponentMap.get('EmailSubscribeDynamic')} />
  {:else}
    <!-- <EmailSubscribe /> -->
  {/if}

  {#if ![routeIdPageProfileArticleCreation, routeIdPageProfileEditArticle].includes($page.route.id )}
     <HeaderRedesigned />
  {/if}

  <main
    class:dark-background={theme == 'Dark'}
    class:dark-mode={theme == 'Dark'}
    class:light-mode={theme == 'Light'}
    class:standard={currentPageRouteId == null }
    class:page-competition={currentPageRouteId == 'CompetitionPage'}
    class:page-profile={currentPageRouteId == 'ProfilePage'}
    class:page-authors={currentPageRouteId == 'AuthorsPage' || currentPageRouteId == "Standard"}
    class:page-content={$page.route.id === routeIdContent}
    class:mobile={VIEWPORT_MOBILE_INIT[1]}
    class:tablet={VIEWPORT_TABLET_INIT[1]}
  >
    <slot />
    {#if (!ispwa && ![routeIdPageProfileArticleCreation, routeIdPageProfileEditArticle].includes($page.route.id || '')) || [routeIdPageProfile, routeIdPageProfilePublication].includes($page.route.id || '')}
      <FooterWidget />
    {/if}
  </main>

  {#if (VIEWPORT_MOBILE_INIT[1] || VIEWPORT_TABLET_INIT[1]) && [routeIdScores, routeIdPageCompetitions, routeIdContent].includes($page.route.id || '')}
    <MobileMenu
      mobile={VIEWPORT_MOBILE_INIT[1]}
      tablet={VIEWPORT_TABLET_INIT[1]}
    />
  {/if}

  <InfoMessages />

  <ModalMain />
</div>

<!--
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸŒŠ Svelte Component CSS/SCSS                                                     â”‚
â”£â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”«
â”‚ â¤ HINT: â”‚ auto-fill/auto-complete iniside <style> for var()                      â”‚
â”‚         â”‚ values by typing/CTRL+SPACE                                            â”‚
â”‚ â¤ HINT: â”‚ access custom Betarena Scores CSS VScode Snippets by typing 'style...' â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
-->

<style lang="scss">

  /*
  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚ ğŸ“² MOBILE-FIRST                                                              â”‚
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  */

  [data-page-id="AuthorsPage"][data-mode="pwa"] {
    background-color: var(--bg-color);
  }

  .app-wrapper {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    &.page-content {
      background-color: var(--bg-color);
    }

    &[data-page-id="Standard"],
    &[data-page-id="CompetitionPage"] {
      background-color: red;
      &.light-mode {
        background-color: var(--whitev2);
      }
    }
  }

  main {
    /* ğŸ“Œ position */
    position: relative;
    z-index: 0;
    margin: 0 auto;
    flex-grow: 1;
    /* ğŸ¨ style */
    width: 100%;
    max-width: 100%;

    &.standard {
      &::before {
        /* ğŸ“Œ position */
        position: absolute;
        z-index: -1;
        top: -5px;
        /* ğŸ¨ style */
        content: "";
        display: inline-block;
        width: 100%;
        height: 435px;
        background-image: url("/assets/svg/header-background.svg");
        background-repeat: no-repeat;
        background-size: cover;
        background-origin: border-box;
        background-position: top;
      }
    }

    &.page-competition::before {
      /* ğŸ¨ style */
      display: none;
    }

    &.page-profile::before {
      /* ğŸ¨ style */
      height: 611px;
    }

    &.page-content {
      display: flex;
      overflow: visible;
      justify-content: space-between;
      max-width: 1265px;
      width: 100%;
      margin: auto;
      padding: 26px 34px;
      padding-top: 32px;
      gap: 34px;

      &.tablet {
        flex-direction: column;
        gap: 0;
        overflow: hidden;
        padding: 0;
      }
      &.mobile {
        padding: 0;
      }
    }
  }

  /*
  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚ âš¡ï¸ RESPONSIVNESS                                                              â”‚
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  */

  @media screen and (min-width: 768px) {
    main {
      &.standard {
        &::before {
          /* ğŸ¨ style */
          height: 495px;
        }
      }

      &.page-profile::before {
        /* ğŸ¨ style */
        height: 611px;
      }
    }
  }

  @media screen and (min-width: 1024px) {
    main {
      /* ğŸ¨ style */
      overflow: hidden;

      &.standard {
        &::before {
          /* ğŸ“Œ position */
          top: calc(100vw / -5.5) !important;
          /* ğŸ¨ style */
          height: 100%;
          background-size: contain !important;
        }
      }

      &.page-profile {
        /* ğŸ¨ style */
        overflow: visible;
      }

      &.page-profile::before {
        /* ğŸ¨ style */
        top: 0 !important;
        height: 10%; /*  939px :: 25% */
        background-size: cover !important;
      }
    }
  }

</style>
